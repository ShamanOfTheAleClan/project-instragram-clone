const doc={get:function(e,t){return"string"==typeof t?document.querySelector(t).querySelector(e):t?t.querySelector(e):document.querySelector(e)},getAll:function(e,t){return"string"==typeof t?Array.prototype.slice.call(document.querySelector(t).querySelectorAll(e)):t?Array.prototype.slice.call(t.querySelectorAll(e)):Array.prototype.slice.call(document.querySelectorAll(e))},id:function(e){return document.getElementById(e)},create:function(e,t,o,n,c){let r=document.createElement(e);if(t&&t.appendChild(r),o&&Array.isArray(o))for(let e=0;e<o.length;e++)r.classList.add(o[e]);else o&&r.classList.add(o);if("object"==typeof n)for(let e=0;e<Object.entries(n).length;e++)r.style.setProperty(Object.entries(n)[e][0],Object.entries(n)[e][1]);if("object"==typeof c)for(let e=0;e<Object.entries(c).length;e++)r.setAttribute(Object.entries(c)[e][0],Object.entries(c)[e][1]);return r}},checkifLoggedIn=()=>{let e=localStorage.getItem("x-auth");console.log(e),e||(window.location.href="./login.html")},profilePage=document.getElementById("profile-page"),registerPage=document.getElementById("registerPage"),loginPage=document.getElementById("loginPage"),feedPage=document.getElementById("feedPage"),commentsPage=document.getElementById("commentsPage"),postUploadPage=doc.id("postUpload");if(loginPage||registerPage||checkifLoggedIn(),profilePage){const e=document.getElementById("optionsCloseBtn"),t=document.getElementById("optionsOpenBtn"),o=document.getElementById("optionsWindow");e.addEventListener("click",()=>{o.style.display="none"}),t.addEventListener("click",()=>{o.style.removeProperty("display")});let n=localStorage.getItem("x-auth"),c=doc.id("profileGallery");fetch("http://localhost:3000/instagram/user/profile",{method:"GET",headers:{"Content-Type":"application/json","x-auth":n}}).then(e=>{if(console.log(e),e)return e.json();throw Error()}).then(e=>{doc.id("postCount").innerText=e.length;let t=doc.id("followingCount"),o=doc.id("followersCount");t.innerText="0",o.innerText="0";for(let t=0;t<e.length;t++){doc.create("img",c,"gallery-photo",0,{src:"../"+e[t].postPic})}}).catch(e=>{console.log(e)})}if(registerPage){const e=()=>{let e=document.getElementById("registerUsername").value,t=document.getElementById("registerEmail").value,o=document.getElementById("registerPassword").value;if(o===document.getElementById("registerRPassword").value){let n={password:o,username:e,email:t};fetch("http://localhost:3000/instagram/user/register",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then(e=>{if(console.log(e),200==e.status)return e.json();alert("Registration failed")}).then(e=>{e&&(window.location.href="../front/login.html")}).catch(e=>{console.log(e)})}};document.getElementById("registerSubmitBtn").addEventListener("click",e)}if(loginPage){const e=()=>{let e=document.getElementById("loginEmail").value,t=document.getElementById("loginPassword").value;console.log("email",e,"password",t);let o={email:e,password:t};fetch("http://localhost:3000/instagram/user/login",{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json"}}).then(e=>{if(console.log(e),!e.ok)throw Error(e);let t=e.headers.get("x-auth");localStorage.setItem("x-auth",t),console.log(t)}).then(e=>{window.location.href="../front/index.html"}).catch(e=>{console.log(e)})};document.getElementById("loginSubmitBtn").addEventListener("click",e)}if(feedPage){(()=>{let e=localStorage.getItem("x-auth");fetch("http://localhost:3000/instagram/post/getAllPosts",{method:"GET",headers:{"x-auth":e,"Content-Type":"application/json"}}).then(e=>{if(console.log(e),!e.ok)throw Error(e);return e.json()}).then(e=>{console.log(e);let t=doc.id("feed");for(let o=0;o<e.length;o++){let n=doc.create("article",0,"post");t.insertBefore(n,t.firstChild);let c=doc.create("section",n,"post-header"),r=doc.create("a",c,"post-author");doc.create("div",r,["user-image","user-image--post-author"],{"background-image":'url("./assets/images/user.jpg")'});doc.create("p",r,"post-author__name").innerText=e[o].user.username;doc.create("img",n,"post-image",0,{src:"../"+e[o].postPic});let l=doc.create("section",n,"post-interactions"),a=doc.create("div",l,"interaction-icons");doc.create("div",a,"interaction-icons__like");doc.create("div",a,"interaction-icons__comment",0,{"data-parentPost":e[o]._id}).addEventListener("click",t=>{window.location.href=`./comments.html?${e[o]._id}`});doc.create("div",a,"interaction-icons__share");doc.create("p",l,["count","count--likes"]).innerText=e[o].likes.length+" likes";let i=doc.create("div",l,"post-comments"),s=doc.create("div",i,"comment");for(doc.create("a",s,"comment__author",0,{href:"./profile.html"}).innerText=e[o].user.username,doc.create("span",s,"comment__content").innerText=e[o].postDescription,j=0;j<e[o].comments.length;j++){let t=doc.create("div",i,"comment");doc.create("a",t,"comment__author",0,{href:"./profile.html"}).innerText=e[o].comments[j].user.username,doc.create("span",t,"comment__content").innerText=e[o].comments[j].comment}}}).catch(e=>{console.log(e)})})()}if(commentsPage){document.getElementById("commentsBackBtn").addEventListener("click",()=>{window.location.href="index.html"});const e=()=>{let e=document.getElementById("commentInput").value,t=localStorage.getItem("x-auth");let o={comment:e,postId:RegExp(/(?:\?)(.*)/g).exec(window.location.href)[1]};fetch("http://localhost:3000/instagram/comment/create",{method:"POST",body:JSON.stringify(o),headers:{"x-auth":t,"Content-Type":"application/json"}}).then(e=>{if(console.log(e),!e.ok)throw Error(e)}).then(e=>{}).catch(e=>{console.log(e)})};(()=>{let e=document.getElementsByClassName("comments"),t=localStorage.getItem("x-auth");const o=RegExp(/(?:\?)(.*)/g).exec(window.location.href)[1];e.innerHTML="",fetch("http://localhost:3000/instagram/comment/getAllComments",{method:"GET",headers:{"x-auth":t,"Content-Type":"application/json","post-id":o}}).then(e=>{if(!e.ok)throw Error(e);return e.json()}).then(e=>{console.log(e);let t=doc.id("comments");for(let o=0;o<e.length;o++){let n=doc.create("article",t,["comment","comment--comments-page"]),c=(doc.create("div",n,["user-image","user-image--post-author"],{"background-image":'url("./assets/images/user.jpg")'}),doc.create("div",n,"comment__text-part"));doc.create("a",c,"comment__author").innerText=e[o].user.username,doc.create("span",c,"comment__content").innerText=e[o].comment}}).catch(e=>{console.log(e)})})(),document.getElementById("postComment").addEventListener("click",t=>{t.preventDefault(),e(),location.reload()})}if(postUploadPage){document.getElementById("submitBtn").addEventListener("click",e=>{e.preventDefault();let t=document.getElementById("submitedFile"),o=doc.id("postDesc").value,n=localStorage.getItem("x-auth"),c=new FormData;c.append("avatar",t.files[0]),c.append("postDescription",o),fetch("http://localhost:3000/instagram/user/uploadFile",{method:"POST",body:c,headers:{"x-auth":n}}).catch(e=>{console.log(e)}),window.location.href="./index.html"})}
//# sourceMappingURL=prod.js.map
